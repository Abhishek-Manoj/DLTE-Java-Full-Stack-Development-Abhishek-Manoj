<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <title>Loan Application Form</title>
</head>
<script>
    var user;
    // alert(user)
    var soapRequest = "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:bank=\"http://bank.project.soap\">\n" +
        "   <soapenv:Header/>\n" +
        "   <soapenv:Body>\n" +
        "      <bank:listLoanRequest/>\n" +
        "   </soapenv:Body>\n" +
        "</soapenv:Envelope>"
    // function fetchDetails(){
    //     $.ajax({
    //         url: "http://localhost:8085/loanPoint",
    //         type: "POST",
    //         dataType: "xml",
    //         contentType: "text/xml;charset=\"UTF-8\"",
    //         data: soapRequest,
    //         success: (data) => {
    //             // alert(data)
    //             $(data).find('ns2\\:loanScheme').each(function() {
    //                 // var id = $(this).find('ns2\\:loanSchemeId').text();
    //                 var type = $(this).find('ns2\\:loanSchemeType').text();
    //                 var name = $(this).find('ns2\\:loanSchemeName').text();
    //                 // var desc = $(this).find('ns2\\:loanSchemeDesc').text();
    //                 // var roi = $(this).find('ns2\\:loanSchemeRoi').text();
    //                 // console.log('name: ' + name + ', type: ' + type + ', desc: ' + desc + ', roi: '+ roi);
    //                 $("#typeSelect").append("<option value='"+type+"'>"+name+"</option>");
    //             });
    //         },
    //         error:()=>{
    //             alert("error")
    //         }
    //     });
    // }

    // $(function () {
    //     fetchDetails()
    // })
    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = window.location.search.substring(1),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
        }
        return false;
    };
    $(document).ready(function () {
        $("#applySubmit").click(()=>{
            // var type = $("select[name=loanType]").val()
            // alert(type)
            var loanId = getUrlParameter('id');
            var loanAmount = $("input[name=loanAmount]").val()
            var loanTenure = $("input[name=loanTenure]").val()
            $.get("http://localhost:8085/template/username",function (data) {
                user = data
            })
            // console.log(loanId+" "+loanAmount+" "+loanTenure+" "+user)
            $.post("http://localhost:8085/template/createLoan", {
                amount: loanAmount,
                tenure: loanTenure,
                type: loanId,
                customer : user,
            },function (data) {
                alert(data)
            })
        })
    })
</script>
<body class="bg-info-subtle">
<div class="container">
    <div class="d-flex justify-content-between">
        <img src="/files/Vibebanklogo.png" height="100px" width="350px" />
        <button type="button" class="btn btn-danger h-75 mt-4" id="logoutBtn">Log Out</button>
    </div>
    <div class="row justify-content-center">
        <h2 class="text-center bg-primary border-5 border-primary mt-2 rounded-3">LOAN APPLICATION</h2>
    </div>
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <form class="card bg-dark-subtle">
                <div class="row justify-content-center">
                    <h5 class="card-title rounded-2 text-bg-danger w-50 text-light text-center mt-3 p-3">Enter Loan Details</h5>
                </div>
                <div class="form-group mt-2 ms-3 me-3">
                    <label>Desired Loan Amount:</label>
                    <input type="text" class="form-control" placeholder="Enter amount" name="loanAmount" />
                </div>
                <div class="form-group mt-2 ms-3 me-3">
                    <label>Tenure of Borrowal:</label>
                    <input type="text" class="form-control" placeholder="Enter " name="loanTenure" />
                </div>
<!--                <div class="form-group mt-2 ms-3 me-3">-->
<!--                    <label>Loan Type:</label>-->
<!--                    <select class="form-control" name="loanType" id="typeSelect">-->
<!--&lt;!&ndash;                        <option value="Housing">HemmaLan</option>&ndash;&gt;-->
<!--&lt;!&ndash;                        <option value="Education">StudieKredit</option>&ndash;&gt;-->
<!--                    </select>-->
<!--                </div>-->
                <div class="d-flex justify-content-around">
                    <button type="button" id="applySubmit" class="btn btn-primary mt-2 mb-4">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>